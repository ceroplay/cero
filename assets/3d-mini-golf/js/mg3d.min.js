var currentLevel=0;!function(){var t,e,p,o,r,u,m,g,f,y,v,i,n,w;function b(t,e){return i.call(t,e)}function a(t,e){var i,n,s,o,r,a,l,h,c,d,p=e&&e.split("/"),u=y.map,m=u&&u["*"]||{};if(t){for(e=(t=t.split("/")).length-1,y.nodeIdCompat&&w.test(t[e])&&(t[e]=t[e].replace(w,"")),"."===t[0].charAt(0)&&p&&(t=p.slice(0,p.length-1).concat(t)),h=0;h<t.length;h++)"."===(d=t[h])?(t.splice(h,1),--h):".."===d&&(0===h||1===h&&".."===t[2]||".."===t[h-1]||0<h&&(t.splice(h-1,2),h-=2));t=t.join("/")}if((p||m)&&u){for(h=(i=t.split("/")).length;0<h;--h){if(n=i.slice(0,h).join("/"),p)for(c=p.length;0<c;--c)if(s=(s=u[p.slice(0,c).join("/")])&&s[n]){o=s,r=h;break}if(o)break;!a&&m&&m[n]&&(a=m[n],l=h)}!o&&a&&(o=a,r=l),o&&(i.splice(0,r,o),t=i.join("/"))}return t}function E(e,i){return function(){var t=n.call(arguments,0);return"string"!=typeof t[0]&&1===t.length&&t.push(null),r.apply(p,t.concat([e,i]))}}function N(t){var e;if(b(f,t)&&(e=f[t],delete f[t],v[t]=!0,o.apply(p,e)),!b(g,t)&&!b(v,t))throw new Error("No "+t);return g[t]}function l(t){var e,i=t?t.indexOf("!"):-1;return-1<i&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function B(t){return t?l(t):[]}g={},f={},y={},v={},i=Object.prototype.hasOwnProperty,n=[].slice,w=/\.js$/,u=function(t,e){var i,n,s=l(t),o=s[0],e=e[1];return t=s[1],o&&(i=N(o=a(o,e))),o?t=i&&i.normalize?i.normalize(t,(n=e,function(t){return a(t,n)})):a(t,e):(o=(s=l(t=a(t,e)))[0],t=s[1],o&&(i=N(o))),{f:o?o+"!"+t:t,n:t,pr:o,p:i}},m={require:function(t){return E(t)},exports:function(t){var e=g[t];return void 0!==e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:(e=t,function(){return y&&y.config&&y.config[e]||{}})};var e}},o=function(t,e,i,n){var s,o,r,a,l,h=[],c=typeof i,d=B(n=n||t);if("undefined"==c||"function"==c){for(e=!e.length&&i.length?["require","exports","module"]:e,a=0;a<e.length;a+=1)if("require"===(o=(r=u(e[a],d)).f))h[a]=m.require(t);else if("exports"===o)h[a]=m.exports(t),l=!0;else if("module"===o)s=h[a]=m.module(t);else if(b(g,o)||b(f,o)||b(v,o))h[a]=N(o);else{if(!r.p)throw new Error(t+" missing "+o);r.p.load(r.n,E(n,!0),function(e){return function(t){g[e]=t}}(o),{}),h[a]=g[o]}c=i?i.apply(g[t],h):void 0,t&&(s&&s.exports!==p&&s.exports!==g[t]?g[t]=s.exports:c===p&&l||(g[t]=c))}else t&&(g[t]=i)},e=t=r=function(t,e,i,n,s){if("string"==typeof t)return m[t]?m[t](e):N(u(t,B(e)).f);if(!t.splice){if((y=t).deps&&r(y.deps,y.callback),!e)return;e.splice?(t=e,e=i,i=null):t=p}return e=e||function(){},"function"==typeof i&&(i=n,n=s),n?o(p,t,e,i):setTimeout(function(){o(p,t,e,i)},4),r},r.config=function(t){return r(t)},e._defined=g,(e=function(t,e,i){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");e.splice||(i=e,e=[]),b(g,t)||b(f,t)||(f[t]=[t,e,i])}).amd={jQuery:!0},e("libs/almond",function(){}),e("rs/mg3d/ui/BlockConfig",[],function(){"use strict";function t(t){this.mg3d=t,this.init()}return t.prototype.init=function(){const t=this.el=document.querySelector(".rs-block-config");t.style.display="block";const e=document.querySelector("#genCode"),i=document.querySelector("#resetBall"),n=this;e.addEventListener("click",function(){n.generateCode()}),i.addEventListener("click",function(){n.mg3d.gameScreen.game3d.resetBall()}),this.blist=[]},t.prototype.generateCode=function(){var t=this.mg3d.gameScreen.game3d.container.puzzleBoard;const e=t.olist;let i={id:1,ballX:0,ballY:0};e.forEach(t=>{i[t.btype]||(i[t.btype]=[]),i[t.btype].push([t.x,t.y])}),i.ballX=Math.floor(t.golfBall.position.x),i.ballY=Math.floor(t.golfBall.position.y),console.log(JSON.stringify(i))},t.prototype.getSelectedBlock=function(){return document.querySelector('input[type="radio"]:checked').value},t.prototype.addBlock=function(t,e,i){this.blist[t]||(this.blist[t]=[]),this.blist[t].push([e,i])},t}),e("rs/mg3d/Preferences",[],function(){"use strict";function t(t,e){this.dataString=e,this.config=t,this.init(e)}return t.prototype.init=function(t){if(null==t){this.data={name:"tk3d",unlocked:[]};for(var e=this.config.data.levels,i=0;i<e.length;i++)this.data.unlocked[i]=0;this.save()}else this.data=JSON.parse(t)},t.prototype.save=function(){null!=this.data&&localStorage.setItem("MiniGolf",JSON.stringify(this.data))},t.prototype.isUnlocked=function(t){return 0==t||1===this.data.unlocked[t]},t.prototype.saveUnlock=function(t){this.data.unlocked[t]=1,this.save()},t}),e("rs/mg3d/AssetManager",[],function(){"use strict";const e="assets/sounds",h="assets/graphics";function t(t){this.mg3d=t,this.init()}return t.prototype.init=function(){var t=this.loadingManager=new THREE.LoadingManager,n=this;t.onLoad=function(){n.loaded=!0,console.log("Assets loaded"),n.onLoad&&n.onLoad.call(n)},t.onProgress=function(t,e,i){n.onProgress&&n.onProgress.call(n,t,e,i)},this.soundOn=!0},t.prototype.load=function(){this.loadAudio(),this.loadTextures(),this.loadModel()},t.prototype.loadAudio=function(){var n=this,s=new THREE.AudioListener;function t(t,e){var i=new THREE.Audio(s);return new THREE.AudioLoader(n.loadingManager).load(t,function(t){i.setBuffer(t),e&&e.call(n)}),i}this.mg3d.config.general.useBackgroundMusic&&(this.bgSound=t(e+"/bg.mp3",function(){this.bgSound.setLoop(!0)})),this.btnClick=t(e+"/btnClick.mp3"),this.firework=t(e+"/firework.mp3",function(){this.firework.setVolume(.25)}),this.wintune=t(e+"/wintune.mp3"),this.losetune=t(e+"/losetune.mp3"),this.ballhit=t(e+"/ballhit.mp3"),this.ballhole=t(e+"/ballhole.mp3")},t.prototype.loadTextures=function(){this.mg3d.defaultOptions;var i=this,t=this.mg3d.config.general.boardTextures;this.boardTextures=[];for(var e,n=0;n<t.length;n++)e=t[n],new THREE.TextureLoader(i.loadingManager).load(h+"/"+e,function(t){i.boardTextures.push(t)});new THREE.TextureLoader(i.loadingManager).load(h+"/lensflare.png",function(t){i.fwTexture=t});var s=new THREE.TextureLoader(i.loadingManager);i.grassTextures=[];for(n=1;n<=5;n++)s.load("assets/textures/"+n+".jpg",function(t){t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,t.repeat.set(4,4),i.grassTextures.push(t)});var o=new THREE.TextureLoader(i.loadingManager);i.otextures=[];for(n=1;n<=4;n++)o.load("assets/otextures/"+n+".jpg",function(t){t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,i.otextures.push(t)});for(var r=new THREE.TextureLoader(i.loadingManager),a=["shadow.png"],n=0;n<a.length;n++){var l=a[n];r.load(h+"/"+l,function(t){var e=t.image.src.split("/").pop().split(".").shift();i[e]=t})}},t.prototype.loadModel=function(){var n=this,t=new THREE.GLTFLoader(n.loadingManager),e=["MineFlag","GolfBall"];for(var i=0;i<e.length;i++)!function(i){t.load("assets/model/"+i+".glb",function(t){var e=t.scene;n[i]=e,n[i+"_Animations"]=t.animations,e.frustumCulled=!1})}(e[i])},t.prototype.toggleSound=function(){this.soundOn=!this.soundOn,this.soundOn?(this.bgSound.setVolume(.8),this.btnClick.setVolume(1),this.firework.setVolume(1),this.wintune.setVolume(1),this.ballhit.setVolume(1),this.ballhole.setVolume(1)):(this.bgSound.setVolume(0),this.btnClick.setVolume(0),this.firework.setVolume(0),this.wintune.setVolume(0),this.ballhit.setVolume(0),this.ballhole.setVolume(0))},t}),e("rs/mg3d/ui/HomeScreenHeader",[],function(){"use strict";function t(t){this.hs=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-hscreen-header";var e=this.hs.config;this.title=document.createElement("h1"),this.title.className="app-title",this.title.innerHTML=e.strings.APP_TITLE,t.appendChild(this.title),this.info=document.createElement("span"),this.info.className="app-info",this.info.innerHTML=e.strings.APP_INFO,t.appendChild(this.info),this.progress=document.createElement("div"),this.progress.className="app-progress",this.progressInner=document.createElement("div"),this.progressInner.className="app-progress-inner",t.appendChild(this.progress),this.progress.appendChild(this.progressInner),this.setProgress(0),this.logo=document.createElement("img"),this.logo.className="app-logo",this.logo.src="assets/graphics/logo.png",this.logo.onmousedown=function(t){t.preventDefault()},t.appendChild(this.logo)},t.prototype.hideProgress=function(){var t=this.progress;anime({targets:t,opacity:0,easing:"easeOutQuint",complete:function(){t.style.display="none"}})},t.prototype.hideLogo=function(){var t=this.logo,e=this.hs.mg3d.isMobile;anime({targets:t,opacity:0,easing:"easeOutQuint",complete:function(){e?t.style.display="none":(anime.remove(t),anime({targets:t,width:32,marginTop:20,opacity:1}))}})},t.prototype.setProgress=function(t){this.progressInner.style.width=t+"%"},t.prototype.moveTop=function(){this.hideProgress(),this.hideLogo(),anime({targets:this.el,top:0,translateY:0,easing:"easeOutQuint",duration:1200})},t.prototype.center=function(){var t=this.hs.mg3d.assetManager,e=this.el;anime({targets:this.el,top:"50%",translateY:"-50%",duration:1400,update:function(){t.showDelay&&(anime.remove(e),anime({targets:e,top:0,translateY:0,duration:0}))}})},t}),e("rs/mg3d/ui/HomeScreenMenu",[],function(){"use strict";function t(t){this.hs=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-hscreenmenu",this.con=document.createElement("div"),this.con.className="menu-list",t.appendChild(this.con);var t=this.hs.config,e=this.hs;this.addItem(t.strings.NEW_GAME,function(){e.startNewGame()}),t.general.useHelpPanel&&this.addItem(t.strings.HELP,function(){e.showHelp()}),t.general.useCreditPanel&&this.addItem(t.strings.CREDITS,function(){e.showCredit()})},t.prototype.addItem=function(t,e){var i=document.createElement("div");i.className="menu-item",i.innerHTML=t,i.style.opacity=0,this.con.appendChild(i);var n=this.hs.mg3d.assetManager;i.addEventListener("click",function(t){e&&e.call(this),n.btnClick.play()})},t.prototype.show=function(){anime({targets:".rs-hscreenmenu .menu-item",opacity:1,easing:"easeOutQuad",delay:anime.stagger(150,{start:500})})},t}),e("rs/game/BasePanel",[],function(){"use strict";function t(t,e){this.width=t||300,this.height=e||300,this.init()}return t.prototype.init=function(){(this.ol=document.createElement("div")).className="rs-game-overlay";var t=this.el=document.createElement("div");t.className="rs-game-panel",t.style.width=this.width+"px",t.style.height=this.height+"px";var e=this.closeBtn=document.createElement("span");e.className="rs-closebtn",e.innerHTML="&times",t.appendChild(e),e.addEventListener("click",this.hide.bind(this))},t.prototype.show=function(){document.body.appendChild(this.ol),document.body.appendChild(this.el),anime.remove(this.el),anime({targets:this.el,opacity:[0,1],duration:800,easing:"easeOutQuint"})},t.prototype.hide=function(){document.body.contains(this.ol)&&document.body.removeChild(this.ol),document.body.contains(this.el)&&document.body.removeChild(this.el)},t.prototype.resize=function(t,e){},t}),e("rs/game/OptionPanel",["rs/game/BasePanel"],function(o){"use strict";function t(t,e){this.data=t,this.callback=e,o.prototype.constructor.call(this)}return((t.prototype=Object.create(o.prototype)).constructor=t).prototype.init=function(){o.prototype.init.call(this);var t=this.el;t.classList.add("rs-game-optionpanel"),t.style.height="auto";var e=this;function i(t){t=t.currentTarget.index;e.callback&&e.callback.call(e,t),e.hide()}for(var n=0;n<this.data.length;n++){var s=document.createElement("div");s.className="rs-optionitem",s.innerHTML=this.data[n],s.index=n,s.addEventListener("click",i),t.appendChild(s)}},t}),e("rs/mg3d/ui/SettingPanel",["rs/game/OptionPanel","rs/game/BasePanel"],function(r,a){"use strict";function t(t){this.mg3d=t,this.config=t.config,a.prototype.constructor.call(this)}return((t.prototype=Object.create(a.prototype)).constructor=t).prototype.init=function(){a.prototype.init.call(this);var t=this.el;t.classList.add("rs-mg3d-spanel"),t.style.width="90%",t.style.height="auto",this.settings={difficulty:"EASY",defaultCategory:0};var e=this.container=document.createElement("div");e.className="rs-settingcontainer",t.appendChild(e);var i,n=[];for(i in this.config.data.level)n.push(i);this.cat=n;var s=this,o=this.mg3d.assetManager,t=this.depanel=new r(n,function(t){s.mg3d.pref.saveDefaultCategory(t),s.updateSettingItem(),o.btnClick.play()}),e=this.dpanel=new r(["EASY","NORMAL","HARD"],function(t){s.mg3d.pref.saveDifficulty(t),s.updateSettingItem(),o.btnClick.play()});this.sitem1=this.buildSettingItem("Difficulty",e),this.sitem2=this.buildSettingItem("Default Category",t)},t.prototype.buildSettingItem=function(t,e){var i=this.mg3d.assetManager,n=document.createElement("div");n.className="rs-settingitem";var s=document.createElement("h3");s.innerHTML=t,n.title=s,n.appendChild(s);s=document.createElement("span");return s.innerHTML="Button",n.btn=s,n.appendChild(s),this.container.appendChild(n),s.addEventListener("click",function(t){e.show(),i.btnClick.play()}),n},t.prototype.show=function(){a.prototype.show.call(this),this.updateSettingItem()},t.prototype.updateSettingItem=function(){var t=this.mg3d.pref;this.sitem1.btn.innerHTML=["EASY","NORMAL","HARD"][t.data.difficulty],this.sitem2.btn.innerHTML=this.cat[t.data.defaultCategory].toUpperCase()},t}),e("rs/utils/BrowserUtil",[],function(){"use strict";var s={bp:{XS:0,SM:576,MD:768,LG:992,XL:1200,XXL:1500,X3L:1900,X4L:2e3,X5L:3e3},computeStyle:function(t,e,i){return void 0===i&&(i="px"),parseFloat(getComputedStyle(t)[e].replace(i,""))},css:function(t,e){for(var i in e)t.style[i]=e[i]},getPrefix:function(){return s.pf||(window.opera||0<=navigator.userAgent.indexOf(" OPR/")?(s.pf="Webkit",s.browserName="Opera"):"undefined"!=typeof InstallTrigger?(s.pf="Moz",s.browserName="Firefox"):window.safari?(s.pf="Webkit",s.browserName="Safari"):window.chrome?(s.pf="Webkit",s.browserName="Chrome"):document.documentMode||/Edge/.test(navigator.userAgent)?(s.pf="ms",s.browserName="MSIE"):(s.pf="Webkit",s.browserName="Safari"),"Webkit"===s.pf?s.ps="":s.ps="px",""!==s.pf?s.csspf="-"+s.pf.toLowerCase()+"-":s.csspf="",console.log(s.pf)),s.pf},getMouseTouchEvents:function(){return this.isMobile()?{mdown:"touchstart",mmove:"touchmove",mup:"touchend"}:{mdown:"mousedown",mmove:"mousemove",mup:"mouseup"}},isMobile:function(){return void 0===s.imb&&(s.imb=null===document.createElement("span").ontouchstart),s.imb},goFullscreen:function(t){var e=s.isFullscreenSupported();return!!e&&(""===e?t.requestFullScreen():t[e+"RequestFullScreen"]())},exitFullscreen:function(t){var e=s.isFullscreenSupported();return!!e&&(!!s.isFullscreen()&&(""===e?document.cancelFullScreen():document[e+"CancelFullScreen"]()))},fullScreenCallback:function(t,e,i){var n=s.isFullscreenSupported();if(!n)return!1;document.addEventListener(n+"fullscreenchange",e)},isFullscreen:function(){var t=s.isFullscreenSupported();if(!t)return!1;switch(t){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[t+"FullScreen"]}},isFullscreenSupported:function(){var t=s.pf.toLowerCase();return void 0!==document.cancelFullScreen?"":void 0!==document[t+"CancelFullScreen"]&&t}};return s}),e("rs/game/Scroller",["rs/utils/BrowserUtil"],function(e){"use strict";var c,d,p;function t(t){p=e.isMobile()?(c="touchstart",d="touchend","touchmove"):(c="mousedown",d="mouseup","mousemove"),this.el=t,this.el.style.overflow="hidden",this.init()}return t.prototype.init=function(){var i,n,s,o,r=this.el,a=this;function e(){r.scrollTop+=.075*(s-r.scrollTop),a.scrollId=requestAnimationFrame(e)}function l(t){var e=2.5*((o=(t.changedTouches?t.changedTouches[0]:t).clientY)-i),t=r.scrollHeight-a.el.clientHeight,e=n-e;s=e=(e=t<e?t:e)<0?0:e,r.style.cursor="grabbing"}function h(t){r.removeEventListener(p,l),r.removeEventListener(d,h),window.removeEventListener(p,l),window.removeEventListener(d,h),cancelAnimationFrame(a.scrollId),r.style.cursor="grab"}r.addEventListener(c,function(t){o=(t.touches?t.touches[0]:t).clientY,i=o,n=s=r.scrollTop,r.addEventListener(p,l),r.addEventListener(d,h),window.addEventListener(p,l),window.addEventListener(d,h),cancelAnimationFrame(a.scrollId),a.scrollId=requestAnimationFrame(e),r.style.cursor="grab"}),r.addEventListener("mouseover",function(t){r.style.cursor="grab"})},t}),e("rs/mg3d/ui/HelpPanel",["rs/game/Scroller","rs/game/BasePanel"],function(e,n){"use strict";t.prototype=Object.create(n.prototype);function t(){n.prototype.constructor.call(this)}return(t.prototype.constructor=t).prototype.init=function(){n.prototype.init.call(this);var t=this.el;t.classList.add("rs-mg3d-helppanel"),t.style.width=t.style.height="90%";var i=this.container=document.createElement("div");i.className="rs-helpcontainer",t.appendChild(i),this.scroller=new e(this.container);t=new XMLHttpRequest;t.addEventListener("load",function(t){var e=this.responseText;i.innerHTML=e}),t.open("GET","assets/text/helpcontent.html"),t.send()},t}),e("rs/mg3d/ui/CreditPanel",["rs/game/BasePanel"],function(n){"use strict";function t(t){this.mg3d=t,n.prototype.constructor.call(this)}return((t.prototype=Object.create(n.prototype)).constructor=t).prototype.init=function(){n.prototype.init.call(this);var t=this.el;t.classList.add("rs-mg3d-cpanel"),t.style.width="90%",t.style.height="auto";var e=this.content=document.createElement("div"),i=this.mg3d.config.strings;e.innerHTML="<h3>"+i.APP_TITLE+"</h3>",e.innerHTML+="<p>"+i.CREDIT_TEXT+"</p>",t.appendChild(e)},t}),e("rs/mg3d/screen/HomeScreen",["rs/mg3d/ui/HomeScreenHeader","rs/mg3d/ui/HomeScreenMenu","rs/mg3d/ui/SettingPanel","rs/mg3d/ui/HelpPanel","rs/mg3d/ui/CreditPanel"],function(e,i,n,s,o){"use strict";function t(t){this.mg3d=t,this.loaded=!1,this.config=t.config,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-hscreen",t.style.width=t.style.height="100%",t.style.display="none",this.header=new e(this),this.menu=new i(this),this.hpanel=new s,this.cpanel=new o(this.mg3d),this.spanel=new n(this.mg3d)},t.prototype.load=function(){this.el.style.display="block",this.el.appendChild(this.header.el),this.header.center();var t=this.mg3d.assetManager,n=this,e=this.header,i=this.menu;t.onLoad=function(){setTimeout(function(){t.showDelay=!0,e.moveTop(),n.el.appendChild(i.el),i.show(),t.bgSound&&t.bgSound.play()},1500)},t.onProgress=function(t,e,i){n.header.setProgress(e/i*100)},this.mg3d.assetManager.load()},t.prototype.transitionIn=function(){this.el.style.display="block",anime({targets:this.el,translateY:0,easing:"easeOutQuint",opacity:1,duration:1200})},t.prototype.transitionOut=function(){var t=this.el;anime({targets:this.el,translateY:-400,easing:"easeOutQuint",opacity:0,duration:1200,complete:function(){t.style.display="none"}})},t.prototype.show=function(){this.mg3d.root.appendChild(this.el),this.mg3d.assetManager.loaded?this.transitionIn():this.load()},t.prototype.hide=function(){this.mg3d.root.removeChild(this.el),this.transitionOut()},t.prototype.startNewGame=function(){this.mg3d.setGameScreen()},t.prototype.showSetting=function(){this.spanel.show()},t.prototype.showHelp=function(){this.hpanel.show()},t.prototype.showCredit=function(){this.cpanel.show()},t.prototype.resize=function(t,e){},t}),e("rs/game/ImagePanel",["rs/game/BasePanel"],function(e){"use strict";function t(){e.prototype.constructor.call(this)}return((t.prototype=Object.create(e.prototype)).constructor=t).prototype.init=function(){e.prototype.init.call(this),this.el.classList.add("rs-image-panel");var i=this.img=document.createElement("img");this.el.appendChild(this.img),this.el.style.width=this.el.style.height="auto",i.addEventListener("click",this.hide.bind(this)),i.onload=function(t){var e=i.naturalWidth/i.naturalHeight;i.naturalHeight>=window.innerHeight&&(i.height=.85*window.innerHeight,i.width=i.height*e),i.naturalWidth>=window.innerWidth&&(i.width=.85*window.innerWidth,i.height=i.width/e)}},t.prototype.show=function(t){this.img.src=t,e.prototype.show.call(this)},t}),e("rs/game/IconButton",["rs/utils/BrowserUtil"],function(s){"use strict";function t(t,e){this.init(t,e)}return t.prototype.init=function(t,e){var i=this.el=document.createElement("span");i.className=t,s.css(i,{display:"block",cursor:"pointer",borderRadius:"50%",textAlign:"center"});var n=this;e&&i.addEventListener("click",function(t){e.call(n)})},t}),e("rs/mg3d/ui/GameButton",["rs/game/IconButton"],function(i){"use strict";function t(t,e){this.init(t,e)}return((t.prototype=Object.create(i.prototype)).constructor=t).prototype.init=function(t,e){i.prototype.init.call(this,t,e),this.el.classList.add("rs-mg3d-mainbutton")},t.prototype.addClass=function(t){this.el.classList.add(t)},t.prototype.removeClass=function(t){this.el.classList.remove(t)},t}),e("rs/mg3d/ui/TrophyPanel",["rs/game/BasePanel","rs/mg3d/ui/GameButton"],function(n,s){"use strict";function t(t){this.gs=t,this.am=t.mg3d.assetManager,n.prototype.constructor.call(this)}return((t.prototype=Object.create(n.prototype)).constructor=t).prototype.init=function(){n.prototype.init.call(this);var t=this.el;t.classList.add("rs-trophy-panel"),t.style.width=t.style.height="90%",this.title=document.createElement("h1"),this.title.className="trophy-level-title",this.title.innerHTML="Level Up";var e=this.meta=document.createElement("div");e.className="meta-container",t.appendChild(e);var i=this.timespan=document.createElement("span");i.innerHTML="Time: 100s",e.appendChild(i),(this.movespan=document.createElement("span")).innerHTML="Moves: 000";e=document.createElement("div");e.className="trophy-container";i=document.createElement("img");i.src="assets/graphics/trophy.png",i.draggable=!1,e.appendChild(i),t.appendChild(e);i=document.createElement("span");i.className="level-label",i.innerHTML=1,e.appendChild(i),this.lvl=i;i=this.btnContainer=document.createElement("div");i.className="trophy-button-container",t.appendChild(i),this.replayBtn=new s("icon-undo",this.doReplay.bind(this)),this.replayBtn.addClass("rs-mg3d-mainbutton-extra"),i.appendChild(this.replayBtn.el),this.nextBtn=new s("icon-nextlevel",this.doNext.bind(this)),this.nextBtn.addClass("rs-mg3d-mainbutton-extra"),i.appendChild(this.nextBtn.el),this.closeBtn.style.display="none"},t.prototype.show=function(){n.prototype.show.call(this),this.setValues(this.gs.getPlayingTime(),this.gs.getMoveCount(),this.gs.currentLevel+1)},t.prototype.hide=function(){n.prototype.hide.call(this),document.body.contains(this.title)&&document.body.removeChild(this.title)},t.prototype.doReplay=function(){this.am.btnClick.play(),this.gs.replayLevel()},t.prototype.doNext=function(){this.am.btnClick.play(),this.gs.nextLevel()},t.prototype.setValues=function(t,e,i){this.timespan.innerHTML="Times: "+t+"s",this.lvl.innerHTML=i,this.movespan.innerHTML="Moves: "+e},t}),e("rs/mg3d/ui/LevelPanel",["rs/game/Scroller","rs/game/BasePanel"],function(i,n){"use strict";function t(t){this.gs=t,this.am=t.mg3d.assetManager,n.prototype.constructor.call(this),this.currentCategory=-1}return((t.prototype=Object.create(n.prototype)).constructor=t).prototype.init=function(){n.prototype.init.call(this);var t=this.el;this.el.classList.add("rs-mg3d-levelpanel"),t.style.width=t.style.height="90%";var e=this.levelTitle=document.createElement("div");e.className="trophy-level-title",e.innerHTML="Levels";e=this.lgc=document.createElement("div");e.className="rs-mg3d-levelgridcontainer",t.appendChild(e),this.lg=document.createElement("div"),this.lg.className="rs-mg3d-levelgrid",e.appendChild(this.lg),this.scroller=new i(this.lgc)},t.prototype.show=function(){n.prototype.show.call(this),this.buildGrid()},t.prototype.hide=function(){n.prototype.hide.call(this)},t.prototype.buildGrid=function(){var t=this.gs.levels.length,e=this.lg,i=this.gs,n=this.gs.mg3d.pref;function s(t){t=t.currentTarget.index;n.isUnlocked(t)&&i.loadLevel(t),i.mg3d.assetManager.btnClick.play()}e.textContent="";for(var o=0;o<t;o++){var r=document.createElement("div");r.className="rs-mg3d-levelgriditem",r.index=o,n.isUnlocked(o)?(r.innerHTML="<span>"+(o+1)+"</span>",r.unlocked=!0):(r.innerHTML='<span class="icon-lock"></span>',r.unlocked=!1),e.appendChild(r),r.addEventListener("click",s)}cancelAnimationFrame(this.scrollId),this.lgc.scrollTop=0;var a=96*Math.floor(this.lg.clientWidth/96);this.lg.style.width=a+"px",this.currentCategory=this.gs.currentCategory},t}),e("rs/mg3d/ui/GameScreenButtonBar",["rs/mg3d/ui/GameButton"],function(e){"use strict";function t(t){this.gs=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-mg3d-gamebuttonbar";this.gs.mg3d.assetManager;this.hintBtn=new e("icon-eye",this.showHint.bind(this)),this.hintBtn.addClass("rs-mg3d-mainbutton-extra"),this.levelBtn=new e("icon-stack",this.showGameLevels.bind(this)),this.levelBtn.addClass("rs-mg3d-mainbutton-extra"),t.appendChild(this.levelBtn.el),this.modeBtn=new e("icon-undo",this.replayLevel.bind(this)),this.modeBtn.addClass("rs-mg3d-mainbutton-extra"),t.appendChild(this.modeBtn.el),this.infoBtn=new e("icon-info",this.showHelp.bind(this)),t.appendChild(this.infoBtn.el),this.homeBtn=new e("icon-home",this.showHome.bind(this)),t.appendChild(this.homeBtn.el),this.soundBtn=new e("icon-sound-on",this.toggleSound.bind(this)),this.soundBtn.isOn=!0},t.prototype.show=function(){anime({targets:this.el,bottom:15,easing:"easeOutQuint",duration:800})},t.prototype.hide=function(){anime({targets:this.el,bottom:-50,easing:"easeOutQuint",duration:800})},t.prototype.showHint=function(){console.log("Show hint"),this.gs.mg3d.assetManager.btnClick.play()},t.prototype.showGameLevels=function(){this.gs.game3d.container.isShuffling||(this.gs.mg3d.assetManager.btnClick.play(),this.gs.levelPanel.show())},t.prototype.replayLevel=function(t){this.gs.mg3d.assetManager.btnClick.play(),this.gs.replayLevel()},t.prototype.showHome=function(t){this.gs.mg3d.assetManager.btnClick.play(),this.gs.mg3d.setHomeScreen()},t.prototype.showHelp=function(t){this.gs.mg3d.assetManager.btnClick.play(),this.gs.hpanel.show()},t.prototype.toggleSound=function(){var t=this.gs.mg3d.assetManager,e=this.soundBtn;e.isOn=!this.soundBtn.isOn,e.isOn?(e.removeClass("icon-sound-off"),e.addClass("icon-sound-on"),t.btnClick.play()):(e.removeClass("icon-sound-on"),e.addClass("icon-sound-off")),t.toggleSound()},t.prototype.getClientSize=function(){return[this.el.clientWidth,this.el.clientHeight]},t}),e("rs/mg3d/ui/GameScreenWonBar",["rs/mg3d/ui/GameButton"],function(e){"use strict";function t(t){this.gs=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-mg3d-gamewonbar",t.style.bottom="-85px",this.status=document.createElement("h1"),this.status.className="trophy-level-title",this.status.innerHTML="DRAW",this.nextBtn=new e("icon-nextlevel",this.doNext.bind(this)),this.nextBtn.addClass("rs-mg3d-mainbutton-extra")},t.prototype.doNext=function(){this.gs.mg3d.assetManager.btnClick.play(),this.gs.nextLevel()},t.prototype.show=function(t){anime({targets:this.el,bottom:12,easing:"easeOutQuint",duration:800}),this.setStatus(t),document.body.appendChild(this.status),this.gs.trophyPanel.show()},t.prototype.setStatus=function(t){this.status.innerHTML=t},t.prototype.hide=function(t){anime({targets:this.el,bottom:-85,easing:"easeOutQuint",duration:800}),document.body.contains(this.status)&&document.body.removeChild(this.status)},t}),e("rs/mg3d/ui/GameScreenLoseBar",["rs/mg3d/ui/GameButton"],function(e){"use strict";function t(t){this.gs=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-mg3d-gamewonbar",t.style.bottom="-85px",this.replayBtn=new e("icon-undo",this.doReplay.bind(this)),this.replayBtn.addClass("rs-mg3d-mainbutton-extra"),t.appendChild(this.replayBtn.el),this.status=document.createElement("h1"),this.status.className="trophy-level-title",this.status.innerHTML="DRAW"},t.prototype.doReplay=function(){this.gs.mg3d.assetManager.btnClick.play(),this.gs.replayLevel()},t.prototype.show=function(t){anime({targets:this.el,bottom:12,easing:"easeOutQuint",duration:800}),this.setStatus(t),document.body.appendChild(this.status)},t.prototype.hide=function(){anime({targets:this.el,bottom:-85,easing:"easeOutQuint",duration:800}),document.body.contains(this.status)&&document.body.removeChild(this.status)},t.prototype.setStatus=function(t){this.status.innerHTML=t},t}),e("rs/mg3d/ui/HeaderTimeButton",[],function(){"use strict";function t(t){this.gh=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-mg3d-timebtn",this.isPlaying=!1,this.currentTime=0;var e=this.gh,i=this;t.addEventListener("click",function(t){e.gs.mg3d.assetManager.btnClick.play(),i.toggleTime()});var n=this.ticon=document.createElement("span");t.appendChild(n),n.className="icon-timer";n=this.tval=document.createElement("span");n.className="timebtn-value",t.appendChild(n),n.innerHTML="00:00:00";n=this.tpause=document.createElement("span");n.className="icon-pausetime",t.appendChild(n)},t.prototype.resume=function(){clearInterval(this.timeId),this.timeId=setInterval(this.timeTick.bind(this),1e3),this.isPlaying=!0,this.tpause.className="icon-pausetime"},t.prototype.pause=function(){clearInterval(this.timeId),this.isPlaying=!1,this.tpause.className="icon-playtime"},t.prototype.reset=function(){this.currentTime=0,this.tval.innerHTML="00:00:00"},t.prototype.timeTick=function(){this.currentTime+=1;var t=this.currentTime,e=Math.floor(t/3600),i=Math.floor((t-3600*e)/60);function n(t){return t<10?"0"+t:t}this.tval.innerHTML=n(e)+":"+n(i)+":"+n((t-3600*e)%60)},t.prototype.toggleTime=function(){this.gh.gs.game3d.isRunningState()&&(this.isPlaying=!this.isPlaying,this.isPlaying?this.resume():this.pause())},t}),e("rs/mg3d/ui/HeaderLevelButton",[],function(){"use strict";function t(t){this.gh=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-mg3d-levelbtn",this.label=document.createElement("span"),this.label.className="levelbtn-label",t.appendChild(this.label),this.btn=document.createElement("span"),this.btn.className="levelbtn-shuffle icon-undo",t.appendChild(this.btn),this.setLevel(1)},t.prototype.setLevel=function(t){function e(){return Math.floor(150*Math.random())}this.label.innerHTML="Level "+t,this.el.style.backgroundColor="rgba("+e()+", "+e()+", "+e()+", 1)"},t}),e("rs/mg3d/ui/HeaderMoveButton",[],function(){"use strict";function t(t){this.gh=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-mg3d-movebtn",this.count=0;var e=this.micon=document.createElement("span");t.appendChild(e),e.className="icon-quill";e=this.mval=document.createElement("span");e.className="movebtn-value",t.appendChild(e),e.innerHTML="000"},t.prototype.addCount=function(t){this.count+=t;for(var e=this.count,i=0,n="";10<=e;)i++,e/=10;for(var i=3-i-1,s=0;s<i;s++)n+="0";this.mval.innerHTML=n+this.count},t.prototype.reset=function(){this.count=0,this.mval.innerHTML="000"},t.prototype.undo=function(){this.gh.gs.game3d.undo()},t}),e("rs/mg3d/ui/DurationBar",[],function(){"use strict";function t(t){this.gh=t,this.init()}return t.prototype.init=function(){var t=document.createElement("div");(this.el=t).className="rs-mg3d-dbar",this.bar=document.createElement("div"),this.bar.className="progress-bar",t.appendChild(this.bar),this.label=document.createElement("div"),this.label.className="duration-label",this.label.innerHTML=100,t.appendChild(this.label)},t.prototype.setValue=function(t){anime({targets:this.bar,width:100*t+"%",easing:"linear",duration:1e3})},t.prototype.setDuration=function(t){this.duration=this.currentValue=this.label.innerHTML=t},t.prototype.start=function(e){var i=this;clearInterval(this.counterId),this.counterId=setInterval(function(){--i.currentValue,i.currentValue<=0&&(e&&e.call(this),i.stop());var t=i.currentValue/i.duration;i.bar.style.width=100*t+"%",i.label.innerHTML=i.currentValue},1e3)},t.prototype.stop=function(){clearInterval(this.counterId)},t.prototype.reset=function(){this.bar.style.width="100%",this.setDuration(this.duration)},t}),e("rs/mg3d/ui/GameScreenHeader",["rs/mg3d/ui/HeaderTimeButton","rs/mg3d/ui/HeaderLevelButton","rs/mg3d/ui/HeaderMoveButton","rs/mg3d/ui/DurationBar"],function(i,n,s,o){"use strict";function t(t){this.gs=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-mg3d-gameheader",this.timeBtn=new i(this),t.appendChild(this.timeBtn.el);const e=this.gs;this.levelBtn=new n(this),t.appendChild(this.levelBtn.el),this.levelBtn.el.addEventListener("click",function(t){e.replayLevel()}),this.moveBtn=new s(this),t.appendChild(this.moveBtn.el),this.dbar=new o(this),this.dbar.setDuration(this.gs.dopt.stepDuration)},t.prototype.getClientSize=function(){return[this.el.clientWidth,this.el.clientHeight]},t.prototype.show=function(){anime({targets:this.el,top:4,easing:"easeOutQuint",duration:800})},t.prototype.hide=function(){anime({targets:this.el,top:-60,easing:"easeOutQuint",duration:800})},t}),e("rs/mg3d/Physics",[],function(){"use strict";const y=.01,v=.005;function t(t){this.g3d=t,this.dopt=t.dopt,this.init()}return t.prototype.init=function(){var t=this.g3d.dopt,e=t.boardThickness,i=t.boardDepth,n=300,s=300,o=n+2*e,r=e,a=t.pieceDepth+i;this.world=new CANNON.World,this.world.gravity.set(0,0,-40),this.world.broadphase=new CANNON.NaiveBroadphase,this.world.solver.iterations=10;var l=new CANNON.Material,h=this.groundMaterial=new CANNON.Material,c=this.wallMaterial=new CANNON.Material,n=new CANNON.ContactMaterial(l,c,{friction:.5,restitution:.9});this.world.addContactMaterial(n);l=this.ball=new CANNON.Body({material:l,mass:1,position:new CANNON.Vec3(-1.2,0,0),shape:new CANNON.Sphere(.15),angularDamping:.3,linearDamping:.3});this.world.addBody(l);l=.5*-(t.pieceDepth+i)*y,t=new CANNON.Body({material:h,mass:0,position:new CANNON.Vec3(-.3,0,l),shape:new CANNON.Box(new CANNON.Vec3(1.2,1.5,i*v))});this.world.addBody(t);t=new CANNON.Body({material:h,mass:0,position:new CANNON.Vec3(1.2,.845,l),shape:new CANNON.Box(new CANNON.Vec3(.3,.675,i*v))});this.world.addBody(t);t=new CANNON.Body({material:h,mass:0,position:new CANNON.Vec3(1.2,-.845,l),shape:new CANNON.Box(new CANNON.Vec3(.3,.675,i*v))});this.world.addBody(t);l=new CANNON.Body({material:h,mass:0,position:new CANNON.Vec3(1.35,0,l),shape:new CANNON.Box(new CANNON.Vec3(.15,.15,i*v))});this.world.addBody(l);const d=this.g3d.am;function p(t){d.ballhit.isPlaying&&d.ballhit.stop(),d.ballhit.play()}const u=new CANNON.Body({material:c,mass:0,position:new CANNON.Vec3(0,(150+.5*e)*y,.5*-i*y),shape:new CANNON.Box(new CANNON.Vec3(o*v,r*v,a*v))});u.addEventListener("collide",p),this.world.addBody(u);const m=new CANNON.Body({material:c,mass:0,position:new CANNON.Vec3(0,(-150-.5*e)*y,.5*-i*y),shape:new CANNON.Box(new CANNON.Vec3(o*v,r*v,a*v))});m.addEventListener("collide",p),this.world.addBody(m),o=e;const g=new CANNON.Body({material:c,mass:0,position:new CANNON.Vec3((-150-.5*e)*y,0,.5*-i*y),shape:new CANNON.Box(new CANNON.Vec3(o*v,1.5,a*v))});g.addEventListener("collide",p),this.world.addBody(g);const f=new CANNON.Body({material:c,mass:0,position:new CANNON.Vec3((150+.5*e)*y,0,.5*-i*y),shape:new CANNON.Box(new CANNON.Vec3(o*v,1.5,a*v))});f.addEventListener("collide",p),this.world.addBody(f),this.olist=[]},t.prototype.update=function(){this.world.step(1/60),window.mg3d_editMode||this.ball.velocity.length()<.005&&!this.g3d.firstTouch&&this.g3d.setLoseState()},t.prototype.reset=function(){this.ball.position.set(window.ballX*y,window.ballY*y,0),this.ball.velocity.set(0,0,0),this.ball.angularVelocity.set(0,0,0)},t.prototype.addBlock=function(t,e){var i=this.dopt.blockSize,n=this.dopt.blockHeight,n=new CANNON.Body({material:this.wallMaterial,mass:0,position:new CANNON.Vec3(t*y,e*y,.5*n*y),shape:new CANNON.Box(new CANNON.Vec3(i*v,i*v,n*v))});return this.world.addBody(n),this.olist.push(n),n},t.prototype.addRBlock=function(t,e){var i=this.dopt.blockSize,n=this.dopt.blockHeight;const s=new CANNON.Body({material:this.wallMaterial,mass:0,position:new CANNON.Vec3(t*y,e*y,.5*n*y),shape:new CANNON.Box(new CANNON.Vec3(i*v,i*v,n*v))});return s.quaternion.setFromEuler(0,0,Math.PI/4),this.world.addBody(s),this.olist.push(s),s},t.prototype.addHBlock=function(t,e){var i=this.dopt.blockSize,n=this.dopt.blockHeight,n=new CANNON.Body({material:this.wallMaterial,mass:0,position:new CANNON.Vec3(t*y,e*y,.5*n*y),shape:new CANNON.Box(new CANNON.Vec3(i*v,2*i*v,n*v))});return this.world.addBody(n),this.olist.push(n),n},t.prototype.addVBlock=function(t,e){var i=this.dopt.blockSize,n=this.dopt.blockHeight,n=new CANNON.Body({material:this.wallMaterial,mass:0,position:new CANNON.Vec3(t*y,e*y,.5*n*y),shape:new CANNON.Box(new CANNON.Vec3(2*i*v,i*v,n*v))});return this.world.addBody(n),this.olist.push(n),n},t.prototype.addCBlock=function(t,e){var i=this.dopt.cylinderRadius,n=this.dopt.blockHeight,n=new CANNON.Body({material:this.wallMaterial,mass:0,position:new CANNON.Vec3(t*y,e*y,.75*n*y),shape:new CANNON.Cylinder(i*y,i*y,1.5*n*y,12)});return this.world.addBody(n),this.olist.push(n),n},t.prototype.addSphere=function(t,e){var i=this.dopt.sphereRadius,i=new CANNON.Body({material:this.wallMaterial,mass:0,position:new CANNON.Vec3(t*y,e*y,0),shape:new CANNON.Sphere(i*y)});return this.world.addBody(i),this.olist.push(i),i},t.prototype.addDoor=function(t,e){var i=this.dopt.blockSize;const n=new CANNON.Body({mass:1,shape:new CANNON.Box(new CANNON.Vec3(.1*i*y,2*i*.5*y,.4*i*y)),linearDamping:.3,angularDamping:.3});e=new CANNON.Body({mass:0,position:new CANNON.Vec3(t*y,e*y,0,.5*i*y),shape:new CANNON.Box(new CANNON.Vec3(.001,.001,.001)),collisionFilterGroup:2}),i=new CANNON.HingeConstraint(e,n,{pivotA:new CANNON.Vec3(.5*i*y,0,.4*i*y),axisA:new CANNON.Vec3(0,0,1),pivotB:new CANNON.Vec3(0,0,0),axisB:new CANNON.Vec3(0,0,1)});return this.world.addConstraint(i),this.world.addBody(n),this.world.addBody(e),this.olist.push(n),n.staticBody=e,n.constraint=i,n},t.prototype.addRDoor=function(t,e){const i=this.addDoor(t,e);return i.constraint.enableMotor(),i.constraint.setMotorSpeed(this.dopt.motorSpeed),i},t.prototype.addSDoor=function(t,e){var i=this.dopt.blockSize,i=new CANNON.Body({material:this.wallMaterial,mass:0,position:new CANNON.Vec3(t*y,e*y,0,.5*i*y),shape:new CANNON.Box(new CANNON.Vec3(.1*i*y,2*i*.5*y,.5*i*y)),linearDamping:.8,angularDamping:.8});return this.world.addBody(i),this.olist.push(i),i},t.prototype.addRamp=function(t,e){var i=this.dopt.blockSize;const n=new CANNON.Body({material:this.wallMaterial,mass:0,position:new CANNON.Vec3(t*y,e*y,.25*i*y),shape:new CANNON.Box(new CANNON.Vec3(2*i*.5*y,.5*i*y,.1*i*y)),linearDamping:.8,angularDamping:.8});return n.quaternion.setFromEuler(0,.175*-Math.PI,0),this.world.addBody(n),this.olist.push(n),n},t.prototype.cleanBlock=function(){for(let t=0;t<this.olist.length;t++){var e=this.olist[t];this.removeBlock(e,!1)}this.olist.splice(0)},t.prototype.removeBlock=function(e,t){if(this.world.removeBody(e),void 0===t&&(t=!0),e.staticBody&&(this.world.removeBody(e.staticBody),this.world.removeConstraint(e.constraint),e.staticBody=null),t)for(let t=this.olist.length-1;0<=t;t--)if(this.olist[t]==e)return void this.olist.splice(t,1)},t.prototype.placeBall=function(t,e){this.ball.position.x=t*y,this.ball.position.y=e*y},t}),e("rs/three/BaseApp",[],function(){"use strict";function t(t,e,i){this.width=t||1e3,this.height=e||600,this.fov=i||60,this.init()}return t.prototype.init=function(){this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(this.fov,this.width/this.height,.1,1e4);var t=this.renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0});t.setSize(this.width,this.height),t.setPixelRatio(window.devicePixelRatio),t.outputEncoding=THREE.sRGBEncoding,this.camera.lookAt(new THREE.Vector3(0,0,0)),this.el=t.domElement,this.raycaster=new THREE.Raycaster},t.prototype._renderRequest=function(t){this.renderer.render(this.scene,this.camera),this.rId=requestAnimationFrame(this._renderRequest.bind(this))},t.prototype.startRendering=function(){this.stopRendering(),this.rId=requestAnimationFrame(this._renderRequest.bind(this))},t.prototype.stopRendering=function(){cancelAnimationFrame(this.rId)},t.prototype.resizeHandler=function(){this.thfov=Math.tan(this.camera.fov*Math.PI/360)},t.prototype.setCameraMatchProjection=function(t){t=t||1;var e=this.camera,i=.5*this.height/Math.tan(e.fov*Math.PI/360);e.position.x=e.position.y=0,e.position.z=i/t,e.lookAt(new THREE.Vector3(0,0,0))},t.prototype._getScaleFitRatio=function(t,e,i){i=i||.75;t=this.width/(t/e)>this.height?this.height*i/e:this.width*i/t;return t},t.prototype.getScaleFitPositionZ=function(t,e,i){this.setCameraMatchProjection();e=this._getScaleFitRatio(t,e,i),i=this.camera.position.z;return i-i/e},t}),e("rs/utils/ObjectUtil",[],function(){"use strict";var n={merge:function(t,e,i){for(var n in t)"[object Object]"===Object.prototype.toString.call(t[n])?(void 0===e[n]&&(e[n]={}),this.merge(t[n],e[n])):e[n]=t[n];return e},clone:function(t,e){var i={};return n.merge(t,i,e),i}};return n}),e("rs/game3d/Firework3DState",[],function(){"use strict";return{EXPLODED:0,FALLING:1,EXPIRED:2}}),e("rs/game3d/Firework3D",["rs/utils/ObjectUtil","rs/game3d/Firework3DState"],function(e,o){"use strict";var r=[16777215,16776960,14352128,16711844,15990528];function t(t){this.config={launchHeight:300,sphereRadius:200,color:16763904,size:72,numParticles:24},e.merge(t=t||{},this.config),this.state=o.EXPLODED,this.init()}return((t.prototype=Object.create(THREE.Points.prototype)).constructor=t).prototype.init=function(){THREE.Points.prototype.constructor.call(this);var t=this.config;this.geometry=new THREE.Geometry;for(var e=this.geometry.vertices,i=0;i<t.numParticles;i++){var n=new THREE.Vector3;n.tX=2*Math.random()*t.sphereRadius-t.sphereRadius+50,n.tY=2*Math.random()*t.sphereRadius-t.sphereRadius+50,n.tZ=2*Math.random()*t.sphereRadius-t.sphereRadius+50,e.push(n)}this.geometry.verticesNeedUpdate=!0;var s=r[Math.floor(Math.random()*r.length)];this.material=new THREE.PointsMaterial({size:t.size,color:s,opacity:1,transparent:!0,blending:THREE.AdditiveBlending,depthTest:!1,map:t.map}),this.material.needsUpdate=!0},t.prototype.setRegion=function(t,e){this.regionWidth=t,this.regionHeight=e},t.prototype.update=function(t){var e=this.geometry.vertices;if(this.state==o.EXPLODED){for(var i=0;i<e.length;i++)(n=e[i]).x+=.1*(n.tX-n.x),n.y+=.1*(n.tY-n.y),n.z+=.1*(n.tZ-n.z);Math.abs(n.tX-n.x)<5&&(this.state=o.FALLING)}else{for(var n,s=-80*t,i=0;i<e.length;i++)(n=e[i]).vy+=s,n.y+=n.vy;this.material.opacity+=.025*(0-this.material.opacity),this.material.opacity<=.05&&this.reset()}this.geometry.verticesNeedUpdate=!0},t.prototype.reset=function(){var t;this.regionWidth&&(this.position.x=Math.random()*this.regionWidth-.5*this.regionWidth,t=this.regionHeight-this.config.launchHeight,this.position.y=Math.random()*t-.5*t),this.state=o.EXPLODED,this.material.opacity=1,this.material.color.set(r[Math.floor(Math.random()*r.length)]),this.rotation.z=0;for(var e=this.geometry.vertices,i=this.config,n=0;n<e.length;n++){var s=e[n];s.x=s.y=s.z=s.vy=0,s.tX=2*Math.random()*i.sphereRadius-i.sphereRadius+50,s.tY=2*Math.random()*i.sphereRadius-i.sphereRadius+50,s.tZ=2*Math.random()*i.sphereRadius-i.sphereRadius+50}this.geometry.verticesNeedUpdate=!0,this.material.needsUpdate=!0,i.callback&&i.callback.call(this)},t}),e("rs/game3d/Firework3DSet",["rs/utils/ObjectUtil","rs/game3d/Firework3D","rs/game3d/Firework3DState"],function(i,s,t){"use strict";function e(t,e){this.g3d=t,this.config={numFireworks:3,interval:500},i.merge(e=e||{},this.config),this.init()}return((e.prototype=Object.create(THREE.Group.prototype)).constructor=e).prototype.init=function(){THREE.Group.prototype.constructor.call(this);for(var t=this.config,e=this.g3d.gs.mg3d.assetManager.fwTexture,i=0;i<t.numFireworks;i++){var n=new s({map:e,callback:t.callback});this.add(n)}},e.prototype.update=function(t){for(var e=0;e<this.children.length;e++)this.children[e].update(t)},e.prototype.changeRegion=function(e,i){this.children.forEach(function(t){t.setRegion(e,i)})},e.prototype.reset=function(){this.children.forEach(function(t){t.reset()})},e}),e("rs/mg3d/entity/Block",[],function(){"use strict";function t(t,e,i,n){this.pb=t,this.physics=t.physics,this.isBlock=!0,this.btype=n||"Block",this.x=Math.floor(e),this.y=Math.floor(i),this.init()}return((t.prototype=Object.create(THREE.Mesh.prototype)).constructor=t).prototype.init=function(){THREE.Mesh.prototype.constructor.call(this);var t=this.pb.dopt,e=t.blockSize,i=t.blockHeight,n=this.pb.texList[this.btype],s=t.sphereRadius,o=t.cylinderRadius;let r,a,l;switch(this.btype){case"Block":r=new THREE.BoxBufferGeometry(e,e,i),a=new THREE.MeshPhongMaterial({map:n}),this.pEntity=this.physics.addBlock(this.x,this.y);break;case"HBlock":r=new THREE.BoxBufferGeometry(e,2*e,i),a=new THREE.MeshPhongMaterial({map:n}),this.pEntity=this.physics.addHBlock(this.x,this.y);break;case"VBlock":r=new THREE.BoxBufferGeometry(2*e,e,i),a=new THREE.MeshPhongMaterial({map:n}),this.pEntity=this.physics.addVBlock(this.x,this.y);break;case"RBlock":r=new THREE.BoxBufferGeometry(e,e,i),a=new THREE.MeshPhongMaterial({map:n}),this.pEntity=this.physics.addRBlock(this.x,this.y);break;case"CBlock":r=new THREE.CylinderGeometry(o,o,1.5*i,12),a=new THREE.MeshPhongMaterial({map:n}),this.pEntity=this.physics.addCBlock(this.x,this.y),this.rotation.x=.5*Math.PI;break;case"Sphere":r=new THREE.SphereGeometry(s,10,10,0,Math.PI),a=new THREE.MeshPhongMaterial({map:n}),this.pEntity=this.physics.addSphere(this.x,this.y);break;case"Door":l=e,r=new THREE.BoxBufferGeometry(.1*l,2*l,.8*l),a=new THREE.MeshPhongMaterial({map:n}),this.pEntity=this.physics.addDoor(this.x,this.y);break;case"RDoor":l=e,r=new THREE.BoxBufferGeometry(.1*l,2*l,.8*l),a=new THREE.MeshPhongMaterial({map:n}),this.pEntity=this.physics.addRDoor(this.x,this.y);break;case"SDoor":l=e,r=new THREE.BoxBufferGeometry(.1*l,2*l,l),a=new THREE.MeshPhongMaterial({map:n}),this.pEntity=this.physics.addSDoor(this.x,this.y);break;case"Ramp":l=e,r=new THREE.BoxBufferGeometry(2*l,l,.1*l),a=new THREE.MeshPhongMaterial({map:n}),this.pEntity=this.physics.addRamp(this.x,this.y)}this.geometry=r,this.material=a,this.update()},t.prototype.update=function(){this.position.copy(this.pEntity.position).multiplyScalar(100),"CBlock"!==this.btype&&this.quaternion.copy(this.pEntity.quaternion)},t.prototype.destroy=function(){this.pEntity=null},t}),e("rs/mg3d/entity/Hole",[],function(){"use strict";function t(t){this.pb=t,this.init()}return((t.prototype=Object.create(THREE.Mesh.prototype)).constructor=t).prototype.init=function(){THREE.Mesh.prototype.constructor.call(this);var t=.5*this.pb.dopt.pieceDepth,e=new THREE.CircleGeometry(16,26),i=new THREE.MeshBasicMaterial({color:797965,transparent:!0,opacity:.9});this.geometry=e,this.material=i,this.position.z=.5-t},t}),e("rs/mg3d/entity/GolfBall",[],function(){"use strict";t.prototype=Object.create(THREE.Group.prototype);function t(t){this.pb=t,this.am=t.am,this.init()}return(t.prototype.constructor=t).prototype.init=function(){THREE.Group.prototype.constructor.call(this);this.pb.dopt;const t=this.model=THREE.SkeletonUtils.clone(this.am.GolfBall);t.scale.set(15,15,15),this.add(t)},t}),e("rs/mg3d/entity/PuzzleBoard",["rs/mg3d/entity/Block","rs/mg3d/entity/Hole","rs/mg3d/entity/GolfBall"],function(n,t,i){"use strict";function e(t,e){this.g3d=t,this.dopt=t.dopt,this.am=t.am,this.physics=e,this.init()}return((e.prototype=Object.create(THREE.Group.prototype)).constructor=e).prototype.init=function(){THREE.Group.prototype.constructor.call(this);const i=this.dopt,n=this;function t(){var t=new THREE.BoxBufferGeometry(10,10,10),e=new THREE.MeshPhongMaterial({specular:i.pieceSpecular,color:16777215,emissive:i.pieceEmissive,side:THREE.FrontSide}),e=new THREE.Mesh(t,e);return n.add(e),e}this.topBoard=t(),this.leftBoard=t(),this.rightBoard=t(),this.bottomBoard=t(),this.backBoard=t(),this.backBoard.isBackboard=!0,this.visible=!0,this.imageWidth=this.imageHeight=300,this.initGolfBall(),this.initHole(),this.initFlag(),this.initArrowLine(),this.arrangeBoard(),this.olist=[]},e.prototype.initGolfBall=function(){var t=this.dopt;this.golfBall=new i(this),this.add(this.golfBall);const e=this.shadowPlane=new THREE.Mesh(new THREE.PlaneBufferGeometry(50,50),new THREE.MeshBasicMaterial({map:this.am.shadow,transparent:!0,opacity:.45}));e.scale.set(.9,.9,.9),e.position.z=.5*-t.pieceDepth+.2,this.add(e)},e.prototype.initHole=function(){this.hole=new t(this),this.hole.position.x=105,this.add(this.hole)},e.prototype.initFlag=function(){this.flag=THREE.SkeletonUtils.clone(this.am.MineFlag),this.flag.scale.set(80,80,80),this.add(this.flag);this.flag.traverse(function(t){var e;t.isMesh&&t.material&&"Plane"==t.name&&((e=t.material.clone()).color.setHex(15870553),t.material=e,t.material.needsUpdate=!0)})},e.prototype.initArrowLine=function(){var t=this.dopt,e=new THREE.MeshLine,i=new THREE.MeshLineMaterial({color:t.forceColor,lineWidth:3,transparent:!0,dashArray:.1,dashRatio:.5}),t=new THREE.MeshLineMaterial({color:t.forceColor,lineWidth:3}),e=this.currentLine=new THREE.Mesh(e,i),i=this.topLine=new THREE.Mesh(new THREE.MeshLine,t),t=this.bottomLine=new THREE.Mesh(new THREE.MeshLine,t);this.add(e),this.add(i),this.add(t)},e.prototype.newGame=function(t){window.ballX=-120;for(let t=window.ballY=0;t<this.olist.length;t++){var e=this.olist[t];this.remove(e)}this.physics.cleanBlock(),this.olist.splice(0),this.shadowPlane.visible=this.golfBall.visible=!0,this.flag.position.x=this.hole.position.x,this.flag.position.z=0,this.flag.rotation.z=.5*-Math.PI,this.physics.reset();const i=this.am.otextures;const n={};if(["Ramp","Block","HBlock","VBlock","RBlock","CBlock","Sphere","Door","RDoor","SDoor","Ramp"].forEach(t=>{var e=i[Math.floor(Math.random()*i.length)];n[t]=e}),this.texList=n,this.updateBoardTexture(),window.mg3d_editMode)console.log("Edit mode");else{for(var s in console.log("Playing mode"),t)if("id"!==s&&"ballX"!==s&&"ballY"!==s){var o=t[s];for(let t=0;t<o.length;t++)this.addBlock(o[t][0],o[t][1],s)}t.ballX&&this.physics.placeBall(t.ballX,t.ballY)}},e.prototype.updateBoardTexture=function(){var t=this.am,e=t.boardTextures[Math.floor(Math.random()*t.boardTextures.length)],t=t.grassTextures[Math.floor(Math.random()*t.grassTextures.length)];this.topBoard.material.map=e,this.topBoard.material.needsUpdate=!0,this.bottomBoard.material.map=e,this.bottomBoard.material.needsUpdate=!0,this.leftBoard.material.map=e,this.leftBoard.material.needsUpdate=!0,this.rightBoard.material.map=e,this.rightBoard.material.needsUpdate=!0,this.backBoard.material.map=t,this.backBoard.material.needsUpdate=!0},e.prototype.arrangeBoard=function(){var t=this.dopt,e=t.boardThickness,i=t.boardDepth,n=this.imageWidth,s=this.imageHeight,o=n+2*e,r=e,t=t.pieceDepth+i;this.topBoard.scale.set(o/10,r/10,t/10),this.topBoard.position.set(0,.5*s+.5*e,.5*-i),this.bottomBoard.scale.set(o/10,r/10,t/10),this.bottomBoard.position.set(0,.5*-s-.5*e,.5*-i),this.leftBoard.scale.set((o=e)/10,(r=s)/10,t/10),this.leftBoard.position.set(.5*-n-.5*e,0,.5*-i),this.rightBoard.scale.set(o/10,r/10,t/10),this.rightBoard.position.set(.5*n+.5*e,0,.5*-i),this.backBoard.scale.set(n/10,s/10,i/10),this.backBoard.position.set(0,0,.5*-t)},e.prototype.getScaleFitPosition=function(t,e){var i=this.dopt,n=this.getBound(),s=n[0],o=n[1],n=n[2],i=i.fitFactor||.98,i=e<t/(s/o)?e*i/o:t*i/s;this.rt=i;s=this.g3d.camera.position.z;return s-s/i-.5*n},e.prototype.calPosition=function(t,e,i){var n=this.imageWidth,s=this.imageHeight,i=n/this.column+(i=null==i?0:i);function o(t){return Math.abs(t)<1e-4?0:t}t=.5*(s-i)-t*i;return[o(.5*-(n-i)+e*i),t=o(t)]},e.prototype.getBound=function(){var t=this.dopt;return[this.imageWidth,this.imageHeight,t.pieceDepth+t.boardDepth]},e.prototype.lineTo=function(t,e,i,n){this.dopt;const s=this.currentLine;s.visible=this.topLine.visible=this.bottomLine.visible=!0;const o=s.geometry;var r=this.golfBall.position.x,a=this.golfBall.position.y;let l=300*(i-.5),h=300*(n-.5);const c=new THREE.Vector2(l-r,h-a);150<c.length()&&(c.setLength(150),l=r+c.x,h=a+c.y),o.setPoints([r,a,12,l,h,12]);i=new THREE.Vector2,n=c.length();const d=c.clone().setLength(.9*n),p=c.clone().setLength(.9*n);d.rotateAround(i,Math.PI/18),p.rotateAround(i,-Math.PI/18);const u=this.topLine.geometry;u.setPoints([l,h,12,d.x+r,d.y+a,12]);const m=this.bottomLine.geometry;m.setPoints([l,h,12,p.x+r,p.y+a,12]),this.currentVec=c},e.prototype.hideFlag=function(){anime.remove(this.flag.position),anime({targets:this.flag.position,z:250,easing:"easeOutQuint"})},e.prototype.addCurrentForce=function(){if(this.currentVec){const e=this.physics.ball;var t=this.dopt.forceScale;e.applyForce(new CANNON.Vec3(this.currentVec.x*t,this.currentVec.y*t,0),e.position)}},e.prototype.hitTest=function(e){for(let t=0;t<this.pieces.length;t++){const i=this.pieces[t];if(i.computeBoundingBox(),i!==e&&i.bb.intersectsBox(e.bb))return!0}return!1},e.prototype.isWon=function(){return!1},e.prototype.update=function(t){this.physics.update();for(let t=0;t<this.olist.length;t++){const n=this.olist[t];n.update()}const e=this.golfBall;var i=this.hole;e.position.copy(this.physics.ball.position).multiplyScalar(100),e.quaternion.copy(this.physics.ball.quaternion);e.position.z<-30&&Math.abs(e.position.y-i.position.y)<5&&Math.abs(e.position.x-i.position.x)<5&&(e.visible=!1,this.shadowPlane.visible=!1,console.log("Level passed"),


levelPassed(currentLevel+1),


this.am.ballhole.play(),this.g3d.setWonState()),(150<Math.abs(e.position.x)||150<Math.abs(e.position.y))&&(console.log("Level failed"),
levelFailed(currentLevel+1),

this.g3d.setLoseState()),this.shadowPlane.position.x=this.golfBall.position.x,this.shadowPlane.position.y=this.golfBall.position.y},e.prototype.addBlock=function(t,e,i){i=new n(this,t,e,i);this.olist.push(i),this.add(i)},e.prototype.removeBlock=function(e){this.remove(e),this.physics.removeBlock(e.pEntity);for(let t=this.olist.length-1;0<=t;t--)if(this.olist[t]==e)return void this.olist.splice(t,1)},e.prototype.placeBall=function(t,e){window.ballX=t,window.ballY=e,this.physics.placeBall(t,e)},e}),e("rs/mg3d/GameLight",[],function(){"use strict";function t(t){this.g3d=t,this.dopt=t.dopt,this.speed=this.dopt.lightMovingSpeed,this.init()}return((t.prototype=Object.create(THREE.Group.prototype)).constructor=t).prototype.init=function(){THREE.Group.prototype.constructor.call(this),this.bound=[300,400,10],this.dirX=1;const t=this.lights=[];t[0]=new THREE.PointLight(15658734,.85,0),t[1]=new THREE.PointLight(15658734,.85,0,2),t[0].position.set(-200,600,-400),t[0].oZ=400,t[1].position.set(150,200,300),t[1].oZ=600,this.add(t[1]);this.g3d.scene,new THREE.PointLightHelper(t[0],5),new THREE.PointLightHelper(t[1],20);var e=new THREE.AmbientLight(this.dopt.ambientLight,.8);this.add(e)},t.prototype.animate=function(){this.lights[1].position.x+=this.dirX*this.speed;var t=this.lights[1].position.x;(t>.5*this.bound[0]||t<.5*-this.bound[0])&&(this.dirX=-this.dirX)},t.prototype.transition=function(){},t.prototype.setBound=function(t,e){this.bound=t;var i=this.lights[1];i.position.set(.5*t[0],0,i.oZ)},t}),e("rs/mg3d/Game3dContainer",["rs/mg3d/entity/PuzzleBoard","rs/mg3d/GameLight"],function(e,i){"use strict";function t(t,e){this.g3d=t,this.init(e)}return((t.prototype=Object.create(THREE.Group.prototype)).constructor=t).prototype.init=function(t){THREE.Group.prototype.constructor.call(this),this.puzzleBoard=new e(this.g3d,t),this.add(this.puzzleBoard);t=this.glight=new i(this.g3d);this.add(t)},t.prototype.fitPuzzleBoard=function(){const t=this.g3d.gs;var e=t.header.getClientSize(),i=t.bbar.getClientSize(),n=this.g3d.el.clientHeight,s=this.g3d.el.clientWidth,i=n-e[1]-i[1]-10;this.g3d.setCameraMatchProjection();i=this.puzzleBoard.getScaleFitPosition(s,i);this.position.z=i,this.glight.setBound(this.puzzleBoard.getBound())},t.prototype.show=function(){this.visible=!1,this.fitPuzzleBoard(),this.rotation.x=-Math.PI/2;const t=this;this.scale.set(.01,.01,.01),anime.remove(this.scale),anime({targets:this.scale,x:1,y:1,z:1,easing:"easeOutQuad",duration:1200}),t.currentRotZ=0,setTimeout(function(){t.currentRotZ=.5*Math.PI},500);var e=-Math.PI/6;this.position.y=20,anime.remove(this.rotation),anime({targets:this.rotation,x:e,easing:"easeOutCubic",delay:400,duration:1500,complete:function(){t.puzzleBoard.hideFlag()}}),setTimeout(function(){t.visible=!0},140)},t.prototype.setWonState=function(){anime.remove(this.rotation),anime({targets:this.rotation,x:-Math.PI/3,easing:"easeOutQuint",duration:800});var t=this.position.z-200;anime.remove(this.position),anime({targets:this.position,z:t,easing:"easeOutQuint",duration:800})},t}),e("rs/mg3d/Game3d",["rs/mg3d/Physics","rs/three/BaseApp","rs/utils/BrowserUtil","rs/game3d/Firework3DSet","rs/mg3d/Game3dContainer"],function(i,n,g,s,o){"use strict";t.prototype=Object.create(n.prototype);const r={RUNNING:0,WON:1,LOSE:2};function t(t){this.gs=t,this.config=t.config,this.mg3d=t.mg3d,this.dopt=this.mg3d.defaultOptions,this.am=this.mg3d.assetManager;n.prototype.constructor.call(this,500,300),this.setCameraMatchProjection(),this.defaultCursor="auto",this.buildScene(),this.initMouseDrag(),window.g3d=this}return(t.prototype.constructor=t).prototype.enableOrbitControl=function(){this.controls=new OrbitControls(this.camera,this.el),this.controls.enableDamping=!0},t.prototype.buildScene=function(){this.clock=new THREE.Clock,this.physics=new i(this),this.container=new o(this,this.physics);const t=this.scene;t.add(this.container);const e=this.am;this.f3ds=new s(this,{numParticles:3,callback:function(){e.firework.play()}}),t.add(this.f3ds),this.setRunningState(),this._setUpRaycaster(),this.resizeHandler()},t.prototype.initMouseDrag=function(){var e,i,n,t=g.getMouseTouchEvents(),s=t.mdown,o=t.mmove,r=t.mup,a=this.el;const l=this,h=this.container,c=h.puzzleBoard;function d(t){c.downPoint||(t=.25*((i=(t.changedTouches?t.changedTouches[0]:t).clientX)-e),h.currentRotZ=n+t*Math.PI/180)}function p(t){l.isDragging=!1,a.removeEventListener(o,d),a.removeEventListener(r,p),window.removeEventListener(o,d),window.removeEventListener(r,p)}a.addEventListener(s,function(t){l.isHover||(l.isDragging=!0,i=(t.touches?t.touches[0]:t).clientX,e=i,n=h.rotation.z,a.addEventListener(o,d),a.addEventListener(r,p),window.addEventListener(o,d),window.addEventListener(r,p))})},t.prototype._setUpRaycaster=function(){const h=this.camera,c=this.raycaster,d=this.container,t=this.el,p=this,u=this.container.puzzleBoard;g.getMouseTouchEvents();const m=this.mg3d.bconfig;function e(t){var e,i=t.touches?(e=t.touches[0].clientX,t.touches[0].clientY):t.changedTouches?(e=t.changedTouches[0].clientX,t.changedTouches[0].clientY):(e=t.offsetX,t.offsetY),i={x:e/p.width*2-1,y:2*-(i/p.height)+1};c.setFromCamera(i,h);for(var n=c.intersectObjects(d.children,!0),s=0;s<n.length;s++){var o,r,a=n[s].object;if("pointerdown"===t.type)if(window.mg3d_editMode&&a.isBackboard&&2===t.button?(o=300*((r=n[s].uv).x-.5),r=300*(r.y-.5),"Ball"===m.getSelectedBlock()?u.placeBall(o,r):u.addBlock(o,r,m.getSelectedBlock()),m.generateCode()):window.mg3d_editMode&&a.isBlock&&2===t.button&&u.removeBlock(a),"GolfBall"===a.name&&p.isRunningState()&&p.firstTouch){let t=s;for(;n[t]&&!n[t].object.isBackboard;)t++;var l=n[t].uv;u.downPoint=l}if("pointermove"===t.type&&u.downPoint){let t=s;for(;n[t]&&!n[t].object.isBackboard;)t++;n[t]&&(a=n[t].uv,l=u.downPoint,u.lineTo(l.x,l.y,a.x,a.y))}break}0===n.length&&t.type}t.addEventListener("pointerdown",e),t.addEventListener("pointermove",e),t.addEventListener("pointerup",function(t){null!=u.downPoint&&(p.firstTouch=!1,u.addCurrentForce(),u.downPoint=null,u.currentLine.visible=u.topLine.visible=u.bottomLine.visible=!1)})},t.prototype.loadLevel=function(t,e){this.setRunningState(),this.firstTouch=!0;this.gs.levels[t];t==this.gs.levels.length&&(t=0);t=this.gs.levels[t];this.container.visible=!1,this.container.puzzleBoard.newGame(t),this.container.show(),e.call(this)},t.prototype._renderRequest=function(){n.prototype._renderRequest.call(this);var t=this.clock.getDelta();if(this.controls&&this.controls.update(),this.state==r.WON&&this.f3ds.update(t),0===this.state){const e=this.container;e.glight.animate(),e.rotation.z+=.075*(e.currentRotZ-e.rotation.z),e.puzzleBoard.update(t),this.mball&&(this.mball.position.copy(this.physics.ball.position).multiplyScalar(100),this.mball.quaternion.copy(this.physics.ball.quaternion))}},t.prototype.setRunningState=function(){this.state=r.RUNNING,this.f3ds.visible=!1,this.gs.header.show()},t.prototype.isRunningState=function(){return this.state==r.RUNNING},t.prototype.setWonState=function(){this.state===r.RUNNING&&(this.state=r.WON,this.container.setWonState(),this.f3ds.visible=!0,this.f3ds.reset(),this.gs.header.timeBtn.pause(),this.gs.header.hide(),this.gs.showWonBar(),this.am.wintune.play(),this.gs.unlockNextLevel())},t.prototype.setLoseState=function(){this.state===r.RUNNING&&(this.state=r.LOSE,this.gs.header.timeBtn.pause(),this.gs.header.hide(),this.gs.showLoseBar(),this.am.losetune.play())},t.prototype.resize=function(t,e){this.width=t,this.height=e,this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e),this.resizeHandler(),this.container.fitPuzzleBoard(),this.f3ds.changeRegion(t,e)},t.prototype.resizeHandler=function(t){n.prototype.resizeHandler.call(this),this.setCameraMatchProjection()},t.prototype.resetBall=function(){const t=this.container.puzzleBoard;t.physics.reset(),this.firstTouch=!0},t.prototype.show=function(){this.el.style.display="block"},t.prototype.hide=function(){this.el.style.display="none"},t.prototype.destroy=function(){},t}),e("rs/mg3d/screen/GameScreen",["rs/game/ImagePanel","rs/mg3d/ui/TrophyPanel","rs/mg3d/ui/LevelPanel","rs/mg3d/ui/HelpPanel","rs/mg3d/ui/GameScreenButtonBar","rs/mg3d/ui/GameScreenWonBar","rs/mg3d/ui/GameScreenLoseBar","rs/mg3d/ui/GameScreenHeader","rs/mg3d/Game3d"],function(t,e,i,n,s,o,r,a,l){"use strict";function h(t,e){this.mg3d=t,this.dopt=t.defaultOptions,this.config=t.config,this.init()}return h.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-gscreen",t.style.width=t.style.height="100%",t.style.display="none",this.levels=this.config.data.levels,this.initPanel(),this.header=new a(this),t.appendChild(this.header.el),this.bbar=new s(this),t.appendChild(this.bbar.el),this.wbar=new o(this),t.appendChild(this.wbar.el),this.lbar=new r(this),t.appendChild(this.lbar.el),this.game3d=new l(this),t.appendChild(this.game3d.el),this.currentLevel=0},h.prototype.initPanel=function(){this.imagePanel=new t,this.trophyPanel=new e(this),this.levelPanel=new i(this),this.mg3d.homeScreen?this.hpanel=this.mg3d.homeScreen.hpanel:this.hpanel=new n},h.prototype.loadLevel=function(t){var e=this;this.trophyPanel.hide(),this.levelPanel.hide(),this.wbar.hide(),this.lbar.hide(),this.showButtonBar(),this.mg3d.showPreloader(),this.game3d.loadLevel(t,function(){e.mg3d.hidePreloader(),e.reset(),e.header.levelBtn.setLevel(t+1),e.header.timeBtn.resume()}),this.currentLevel=t},h.prototype.loadCategory=function(t){this.currentCategory=t,this.loadLevel(0)},h.prototype.replayLevel=function(){this.loadLevel(this.currentLevel)},h.prototype.nextLevel=function(){var t=this.currentLevel+1;

currentLevel=t;

  t==this.levels.length&&(t=0),this.loadLevel(t)},h.prototype.unlockNextLevel=function(){var t=this.currentLevel+1;this.levels[this.currentCategory];t<this.levels.length&&this.mg3d.pref.saveUnlock(t)},h.prototype.getCurrentImagePath=function(){var t=this.levels[this.currentCategory].content[this.currentLevel].path;return t=null==t?this.game3d.container.puzzleBoard.dataUrl:t},h.prototype.reset=function(){this.header.timeBtn.reset(),this.header.moveBtn.reset()},h.prototype.show=function(t){this.currentCategory=0,this.mg3d.root.appendChild(this.el),this.transitionIn();var e=this.mg3d.getAppDimension();this.game3d.resize(e[0],e[1]),this.game3d.startRendering(),this.loadLevel(t=null==t?0:t)},h.prototype.hide=function(){this.mg3d.root.removeChild(this.el),this.game3d.stopRendering()},h.prototype.showWonBar=function(){this.bbar.hide();var t=this.wbar;setTimeout(function(){t.show("Level Passed")},400)},h.prototype.showLoseBar=function(){this.bbar.hide();var t=this.lbar;setTimeout(function(){t.show("Level Failed")},400)},h.prototype.showButtonBar=function(){this.wbar.hide();var t=this.bbar;setTimeout(function(){t.show()},400)},h.prototype.transitionIn=function(){this.el.style.display="block"},h.prototype.transitionOut=function(){},h.prototype.getMoveCount=function(){return this.header.moveBtn.count},h.prototype.getPlayingTime=function(){return this.header.timeBtn.currentTime},h.prototype.resize=function(t,e){this.game3d.resize(t,e)},h.prototype.dispose=function(){},h}),e("rs/utils/MouseUtil",["rs/utils/BrowserUtil"],function(m){"use strict";function n(t){t.preventDefault(),t.currentTarget.mouseWheelCallback.call(t.currentTarget.mousewheelContext,Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)))}return{touchClick:function(t,e){m.isMobile()?t.addEventListener("touchstart",e):t.addEventListener("click",e)},removeTouchClick:function(t,e){m.isMobile()?t.removeEventListener("touchstart",e):t.removeEventListener("click",e)},startMouseWheel:function(t,e,i){t.mouseWheelCallback=e,t.mousewheelContext=i,t.addEventListener("DOMMouseScroll",n,!1),t.addEventListener("mousewheel",n,!1)},stopMouseWheel:function(t){t.removeEventListener("DOMMouseScroll",n),t.removeEventListener("mousewheel",n)},swipeStart:function(e,t,i,n,s){var o,r;function a(t){o=t.clientX,r=t.clientY,(new Date).getTime(),e.addEventListener("mousemove",h),window.addEventListener("mouseup",c)}function l(t){e.removeEventListener("mousemove",h),window.removeEventListener("mouseup",c),e.removeEventListener("mouseout",l)}function h(t){var e=t.clientX-o,t=t.clientY-r;m.swipeState="move",Math.abs(e)>Math.abs(t)?n(e*i):s(t*i)}function c(t){e.removeEventListener("mousemove",h),window.removeEventListener("mouseup",c)}function d(t){o=t.touches[0].clientX,r=t.touches[0].clientY,(new Date).getTime(),e.addEventListener("touchmove",p),window.addEventListener("touchend",u)}function p(t){t.preventDefault();var e=t.changedTouches[0].clientX-o,t=t.changedTouches[0].clientY-r;m.swipeState="move",Math.abs(e)>Math.abs(t)?n(e*i):s(t*i)}function u(t){e.removeEventListener("touchmove",p),window.removeEventListener("touchend",u)}e.style[m.getPrefix()+"UserSelect"]="none",e.removeTracking=function(){e.removeEventListener("mousedown",a),window.removeEventListener("mouseup",c),e.removeEventListener("mousemove",h),e.removeEventListener("mouseout",l),e.removeEventListener("touchstart",d),e.removeEventListener("touchend",u),e.removeEventListener("touchmove",p),e.removeTracking=null},m.isMobile()?e.addEventListener("touchstart",d):e.addEventListener("mousedown",a)},swipeStop:function(t){t.style[m.getPrefix()+"UserSelect"]="all",t.removeTracking&&t.removeTracking()}}}),e("rs/mg3d/FullscreenButton",["rs/utils/BrowserUtil","rs/utils/MouseUtil"],function(o,r){"use strict";function t(t,e){this.targetEl=t,this.build("icon-screen-full",e)}return t.prototype.build=function(t,e){var i=this,n=this.targetEl,s=this.el=document.createElement("span");s.className=t+" rs-mg3d-fsbtn",r.touchClick(s,function(t){o.isFullscreen()?o.exitFullscreen(n):o.goFullscreen(n)}),o.fullScreenCallback(n,function(){o.isFullscreen()?i.setFull():i.setNormal(),e.call(n)})},t.prototype.setFull=function(){this.el.classList.remove("icon-screen-full"),this.el.classList.add("icon-screen-normal")},t.prototype.setNormal=function(){this.el.classList.remove("icon-screen-normal"),this.el.classList.add("icon-screen-full")},t}),e("rs/ui/RingPreloader",["rs/utils/ObjectUtil"],function(e){"use strict";function t(t){this.dopt={size:40,borderWidth:6,borderColor:"#AAA"},e.merge(t,this.dopt),this.build()}return t.prototype.build=function(){var t=this.dopt,e=this.el=document.createElement("div");e.className="rs-ringpreloader",e.innerHTML="<div class='lds-ring'><div></div><div></div><div></div><div></div></div>",e.style.marginLeft=e.style.marginTop=.5*-t.size+"px";for(var i=e.firstChild.children,n=0;n<i.length;n++){var s=i[n].style;s.width=s.height=t.size+"px",s.borderWidth=t.borderWidth+"px",s.borderTopColor=t.borderColor}},t.prototype.show=function(){this.el.style.display="block"},t.prototype.hide=function(){this.el.style.display="none"},t}),e("rs/mg3d/MiniGolf",["rs/mg3d/ui/BlockConfig","rs/mg3d/Preferences","rs/mg3d/AssetManager","rs/mg3d/screen/HomeScreen","rs/mg3d/screen/GameScreen","rs/mg3d/FullscreenButton","rs/ui/RingPreloader","rs/utils/ObjectUtil","rs/utils/BrowserUtil"],function(e,t,i,n,s,o,r,a,l){"use strict";function h(t,e){this.loadConfig(),this.defaultOptions={colors:[3781962,15817252,7687204,15590190,2730978,15539833,3027346,16777215,3355443],pieceDepth:18,pieceSpecular:855309,pieceEmissive:65793,pieceColor:16763904,stepDuration:3,boardDimension:3,boardThickness:6,boardDepth:6,boardMaxWidth:780,boardMaxHeight:780,forceColor:16777215,forceScale:6,blockSize:50,blockHeight:24,sphereRadius:30,cylinderRadius:30,motorSpeed:2.5,fitFactor:.85,ambientLight:3355443,lightMovingSpeed:3},a.merge(e=e||{},this.defaultOptions),this.root=t,l.css(this.root,{position:"relative",display:"block",overflow:"hidden"});const i=this;window.addEventListener("resize",function(t){i.resize()}),document.body.addEventListener("click",function(t){})}return h.prototype.loadConfig=function(){var i=this,t=new XMLHttpRequest;t.addEventListener("load",function(t){var e=JSON.parse(this.response);i.config=e,i.initComponents()}),t.open("GET","config.json"),t.send()},h.prototype.initComponents=function(){const t=this;this.defaultOptions,this.config;this.initPreferences(),this.initPreloader(),this.activeScreen=null,this.assetManager=new i(this),window.location.search.includes("edit")&&(window.mg3d_editMode=!0,this.bconfig=new e(this),document.body.appendChild(this.bconfig.el),document.oncontextmenu=function(){return!1}),window.location.search.includes("bypass")?(this.assetManager.onLoad=function(){t.setGameScreen()},this.assetManager.load()):this.setHomeScreen(),setTimeout(function(){t.resize()},200)},h.prototype.initPreferences=function(){this.pref=new t(this.config,localStorage.getItem("MiniGolf"))},h.prototype.initPreloader=function(){var t=new r({borderColor:"#ccc"}).el;(this.preloader=t).style.top="50%"},h.prototype.showPreloader=function(){this.root.appendChild(this.preloader)},h.prototype.hidePreloader=function(){this.root.contains(this.preloader)&&this.root.removeChild(this.preloader)},h.prototype.initFullcreen=function(){this.fsbtn=new o(this.root,function(t){console.log("fullsceen change")}),this.root.appendChild(this.fsbtn.el)},h.prototype.addEventListener=function(t,e){this.root.addEventListener(t,e)},h.prototype.setScreen=function(t){this.activeScreen&&this.activeScreen.hide(),t.show(),this.activeScreen=t},h.prototype.setGameScreen=function(){this.gameScreen||(this.gameScreen=new s(this)),this.setScreen(this.gameScreen)},h.prototype.setHomeScreen=function(){this.homeScreen||(this.homeScreen=new n(this)),this.setScreen(this.homeScreen)},h.prototype.dispose=function(){},h.prototype.logPosition=function(){this.gameScreen.game3d.container.puzzleBoard.logPosition()},h.prototype.resize=function(){var t=this.getAppDimension(),e=t[0],t=t[1];this.activeScreen&&this.activeScreen.resize(e,t)},h.prototype.getAppDimension=function(){var t=l.computeStyle,e=t(this.root,"borderTopWidth");return[t(this.root,"width")-2*e,t(this.root,"height")-2*e]},h}),window.MiniGolf=t("rs/mg3d/MiniGolf")}();

var levelPassed=function(lvl){

  console.log('squid_gamesurvival_ginthqns','lagdevaF3001');


  var ach=false;
  var ach_numb=[];

  if(lvl>29){
  ach=true;
  ach_numb.push("twd_minigolf_rvkkq005");
  }
  if(lvl>19){
  ach=true;
  ach_numb.push("twd_minigolf_rvkkq004");
  }
  if(lvl>9){
  ach=true;
  ach_numb.push("twd_minigolf_rvkkq003");
  }
  if(lvl>5){
  ach=true;
  ach_numb.push("twd_minigolf_rvkkq002");
  }
  if(lvl>2){
  ach=true;
  ach_numb.push("twd_minigolf_rvkkq001");
  }
  if(ach){
  LaggedAPI.Achievements.save(ach_numb, function(response) {
  if(response.success) {
  console.log('achievement saved')
  }else {
  console.log(response.errormsg);
  }
  });
  }

  
}
var levelFailed=function(lvl){
  LaggedAPI.APIAds.show('interstitial','3d-mini-golf','3d-mini-golf-game.png',function(response) {
  if(response.success) {
  console.log('ad done');
  }else {
  console.log('ad error, continue');
  }
  });
}
